<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OBS VLC Overlay</title>
    <link href="/style.css" rel="stylesheet">
  </head>
  <body class="fixed w-full h-screen bg-[#00ff00] text-white text-2xl flex flex-col justify-end">
    <div id="app" class="w-full flex flex-row justify-center"></div>
    <script>
      const updateUrl = '/requests/status.json';

      const updateData = async () => {
          const response = await fetch(updateUrl);
          const data = await response.json()
          const { album, artist, artwork_url, title, position } = data.information.category.meta

          // console.info(data, { album, artist, artwork_url, title });

          document.querySelector('#music-info #artist').innerHTML = artist + '&nbsp;-&nbsp;';
          document.querySelector('#music-info #title').innerHTML = '"' + title + '"';
          document.querySelector('#music-info #album').innerHTML = '&nbsp;(' + album + ')';
          // document.querySelector('#music-artwork img').src = artwork_url + ;
          // document.querySelector('#music-artwork img').alt = '';
      };

      document.querySelector('#app').innerHTML = `
        <div class="flex flex-col justify-self-stretch mb-8">
          <div id="music-info" class="flex flex-row justify-self-stretch">
            <div id="artist" class="flex"></div>
            <div id="title" class="flex"></div>
            <div id="album" class="flex"></div>
          </div>
          <div id="music-progress" class="flex">
            <div id="music-elapsed"></div>
          </div>
        </div>
      `;

      const start = () => {
        setInterval(updateData, 1000);
      };

      document.addEventListener('DOMContentLoaded', start);
    </script>
  </body>
</html>
